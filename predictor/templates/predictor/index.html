<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D·ª± ƒëo√°n Thu nh·∫≠p</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f4f4f4; margin: 0; padding: 20px; }
        .container { max-width: 600px; margin: auto; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #333; }
        form { display: flex; flex-direction: column; gap: 15px; }
        label { font-weight: bold; margin-bottom: -10px; }
        input[type="number"], select { padding: 10px; border-radius: 4px; border: 1px solid #ccc; }
        button { padding: 10px 15px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
        button:hover { background-color: #0056b3; }
        #result-container { margin-top: 20px; text-align: center; }
        #result { font-size: 1.5em; font-weight: bold; color: #333; }
        .loading { display: none; color: #555; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä Trang web D·ª± ƒëo√°n Thu nh·∫≠p</h1>
        <p>Nh·∫≠p th√¥ng tin nh√¢n kh·∫©u h·ªçc ƒë·ªÉ d·ª± ƒëo√°n thu nh·∫≠p (tr√™n ho·∫∑c d∆∞·ªõi $50K/nƒÉm).</p>
        
        <form id="income-form">
            <label for="age">Tu·ªïi (Age):</label>
            <input type="number" id="age" name="age" value="30" required>

            <label for="workclass">Lo·∫°i h√¨nh C√¥ng vi·ªác (Workclass):</label>
            <select id="workclass" name="workclass">
                <option value="Private">T∆∞ nh√¢n (Private)</option>
                <option value="Self-emp-not-inc">T·ª± kinh doanh (Self-emp-not-inc)</option>
                <option value="Local-gov">Ch√≠nh ph·ªß ƒë·ªãa ph∆∞∆°ng (Local-gov)</option>
                <option value="State-gov">Ch√≠nh ph·ªß ti·ªÉu bang (State-gov)</option>
                <option value="Federal-gov">Ch√≠nh ph·ªß li√™n bang (Federal-gov)</option>
                <option value="Self-emp-inc">T·ª± kinh doanh (c√≥ ƒëƒÉng k√Ω)</option>
                <option value="Without-pay">Kh√¥ng l∆∞∆°ng</option>
            </select>

            <label for="education-num">S·ªë nƒÉm H·ªçc v·∫•n (Education-num):</label>
            <input type="number" id="education-num" name="education-num" value="13" required>

            <label for="marital-status">T√¨nh tr·∫°ng H√¥n nh√¢n (Marital-status):</label>
            <select id="marital-status" name="marital-status">
                <option value="Married-civ-spouse">ƒê√£ k·∫øt h√¥n (v·ª£/ch·ªìng d√¢n s·ª±)</option>
                <option value="Never-married">Ch∆∞a k·∫øt h√¥n</option>
                <option value="Divorced">ƒê√£ ly h√¥n</option>
                <option value="Separated">Ly th√¢n</option>
                <option value="Widowed">G√≥a</option>
            </select>
            
            <label for="hours-per-week">S·ªë gi·ªù l√†m m·ªói tu·∫ßn (Hours-per-week):</label>
            <input type="number" id="hours-per-week" name="hours-per-week" value="40" required>

            <label for="capital-gain">L·ª£i nhu·∫≠n v·ªën (Capital-gain):</label>
            <input type="number" id="capital-gain" name="capital-gain" value="0" required>

            <label for="capital-loss">T·ªïn th·∫•t v·ªën (Capital-loss):</label>
            <input type="number" id="capital-loss" name="capital-loss" value="0" required>

            <button type="submit">D·ª± ƒëo√°n</button>
        </form>

        <div id="result-container">
            <h2>K·∫øt qu·∫£ D·ª± ƒëo√°n:</h2>
            <p class="loading" id="loading">ƒêang x·ª≠ l√Ω...</p>
            <p id="result">---</p>
        </div>
    </div>

<script>
    document.getElementById('income-form').addEventListener('submit', function(e) {
        e.preventDefault(); 

        // Hi·ªÉn th·ªã tr·∫°ng th√°i "ƒêang x·ª≠ l√Ω"
            const resultEl = document.getElementById('result');
            const loadingEl = document.getElementById('loading');
            resultEl.innerText = '---';
            loadingEl.style.display = 'block';

        // 1. Thu th·∫≠p d·ªØ li·ªáu t·ª´ c√°c √¥ input
            const data = {
                'age': parseInt(document.getElementById('age').value),
                'workclass': document.getElementById('workclass').value,
                'education-num': parseInt(document.getElementById('education-num').value),
                'marital-status': document.getElementById('marital-status').value,
                'hours-per-week': parseInt(document.getElementById('hours-per-week').value),
                'capital-gain': parseInt(document.getElementById('capital-gain').value),
                'capital-loss': parseInt(document.getElementById('capital-loss').value)
                
                // L∆∞u √Ω: Ch√∫ng ta ch·ªâ c·∫ßn g·ª≠i c√°c c·ªôt c√≥ trong form.
                // Backend (app.py) s·∫Ω t·ª± ƒë·ªông x·ª≠ l√Ω c√°c c·ªôt c√≤n l·∫°i.
            };
        // G·ª≠i d·ªØ li·ªáu ƒë·∫øn URL API Django
        fetch('/predict/', {  // CH·ªàNH S·ª¨A URL: '/predict/'
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                // Django c·∫ßn token CSRF n·∫øu l√† form truy·ªÅn th·ªëng, 
                // nh∆∞ng v·ªõi fetch/JSON, ch√∫ng ta d√πng @csrf_exempt trong views.py
            },
            body: JSON.stringify(data)
        })
        .then(response => response.json())
        .then(data => {
            // 3. Hi·ªÉn th·ªã k·∫øt qu·∫£
            loadingEl.style.display = 'none';
            if (data.prediction) {
                resultEl.innerText = `Thu nh·∫≠p: ${data.prediction}`;
            } else {
                resultEl.innerText = `L·ªói: ${data.error}`;
            }
        })
        .catch(error => {
           // 4. X·ª≠ l√Ω n·∫øu c√≥ l·ªói
            loadingEl.style.display = 'none';
            console.error('Error:', error);
            resultEl.innerText = 'ƒê√£ x·∫£y ra l·ªói khi k·∫øt n·ªëi server.';
        });
    });
</script>
</body>
</html>